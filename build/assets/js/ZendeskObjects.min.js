"use strict";function ZendeskOrganization(e,t,s,i){this.app=e,this.id=t,this.name=s,this.customer_type=i,this.extra_org_fields=[];for(var r=0;r<e.organization_field_mappings.length;r++)this.extra_org_fields[r]={field_def:e.organization_field_mappings[r],value:null}}function ZendeskUser(e,t,s,i,r,a){this.app=e,this.id=t,this.name=s,this.name_parts=null,this.email=i,this.customer_type=r,this.organization_id=void 0===a?null:a,this.orgObject=null,this.extra_user_fields=[];for(var l=0;l<e.user_field_mappings.length;l++)this.extra_user_fields[l]={field_def:e.user_field_mappings[l],value:null}}ZendeskOrganization.prototype.populateExtraFieldsFromOrganizationAPIData=function(e){for(var t=0;t<this.extra_org_fields.length;t++)this.extra_org_fields[t].value=e.organization_fields[this.extra_org_fields[t].field_def.zendesk_field]},ZendeskOrganization.prototype.populateExtraFieldsFromFrameworkOrgObject=function(e){for(var t=0;t<this.extra_org_fields.length;t++)this.extra_org_fields[t].value=e.customField(this.extra_org_fields[t].field_def.zendesk_field)},ZendeskOrganization.prototype.clone=function(){for(var e=new ZendeskOrganization(this.app,this.id,this.name,this.customer_type),t=0;t<this.extra_org_fields.length;t++)e.extra_org_fields[t]={field_def:this.extra_org_fields[t].field_def,value:this.extra_org_fields[t].value};return e},ZendeskUser.prototype.getSalutation=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.salutation?"":this.name_parts.salutation.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},ZendeskUser.prototype.getForeName=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.firstName?"":this.name_parts.firstName.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},ZendeskUser.prototype.getSurname=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.lastName?"":this.name_parts.lastName.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},ZendeskUser.prototype.populateNamePartsIfNecessary=function(){null===this.name_parts&&null!==this.name&&(this.name_parts=this.app.parseNamesModule.parse(this.name.replace("/"," ").replace("."," ").split(",").reverse().map(Function.prototype.call,String.prototype.trim).join(" ")))},ZendeskUser.prototype.populateExtraFieldsFromUserAPIData=function(e){for(var t=0;t<this.extra_user_fields.length;t++)this.extra_user_fields[t].value=e.user_fields[this.extra_user_fields[t].field_def.zendesk_field]},ZendeskUser.prototype.populateExtraFieldsFromFrameworkUserObject=function(e){for(var t=0;t<this.extra_user_fields.length;t++)this.extra_user_fields[t].value=e.customField(this.extra_user_fields[t].field_def.zendesk_field)},ZendeskUser.prototype.clone=function(){var e=new ZendeskUser(this.app,this.id,this.name,this.email,this.customer_type,this.organization_id);e.orgObject=null===this.orgObject?null:this.orgObject.clone();for(var t=0;t<this.extra_user_fields.length;t++)e.extra_user_fields[t]={field_def:this.extra_user_fields[t].field_def,value:this.extra_user_fields[t].value};return e},ZendeskUser.prototype.isNotset=function(){return this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_NOT_SET},ZendeskUser.prototype.isExcluded=function(){return this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_EXCLUDE},ZendeskUser.prototype.isIncluded=function(){return this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_USE_ORGANIZATION||this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_USE_DEFAULT},ZendeskUser.prototype.isOrganization=function(){return this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_USE_ORGANIZATION},ZendeskUser.prototype.isDefault=function(){return this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_USE_DEFAULT},ZendeskUser.prototype.belongsToOrganization=function(){return null!==this.organization_id},ZendeskUser.prototype.orgObjectIsPopulated=function(){return null!==this.orgObject},ZendeskUser.prototype.getMailchimpCustomerType=function(){return void 0===this.customer_type||null===this.customer_type?(console.warn("ZendeskUser.getMailchimpCustomerType() called with invalid customer_type, this = "),console.dir(this),null):this.customer_type===this.app.resources.USER_FIELD_NAME_CUSTOMER_TYPE_VALUE_USE_ORGANIZATION?this.orgObject.customer_type:this.app.customer_type_field_mapping.default_value},ZendeskUser.prototype.findExtraFieldByName=function(e,t){for(var s=0;s<this.extra_user_fields.length;s++)if(t&&this.extra_user_fields[s].field_def.zendesk_field===e||!t&&this.extra_user_fields[s].field_def.mailchimp_field===e)return this.extra_user_fields[s]},ZendeskUser.prototype.getFieldSyncInfo=function(e){if(null==e)return null;if(void 0===this.customer_type||null===this.customer_type||this.isNotset())return console.warn("ZendeskUser.getFieldSyncInfo() called with invalid customer_type, this = "),console.dir(this),null;for(var t=[{label:"Email",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.email,mc_value:e.email_address,in_sync:this.email.toLowerCase()===e.email_address.toLowerCase()},{label:"Name",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.name,mc_value:"["+e.forename+"] ["+e.surname+"]",in_sync:e.forename.toLowerCase()===this.getForeName().toLowerCase()&&e.surname.toLowerCase()===this.getSurname().toLowerCase()},{label:"Customer Type",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.getMailchimpCustomerType(),mc_value:e.customer_type,in_sync:this.getMailchimpCustomerType()===e.customer_type}],s=null,i=null,r=0,a=0;a<this.extra_user_fields.length;a++)s=null===(s=this.extra_user_fields[a].value)?"":s,i=null===(i=e.extra_merge_fields[r].value)?"":i,t[r+3]={label:this.extra_user_fields[a].field_def.field_label,zd_field_location:"user",is_image:this.extra_user_fields[a].field_def.type===this.app.resources.FIELD_TYPE_IMAGE,zd_value:s,mc_value:i,in_sync:s===i},r++;for(a=0;a<this.app.organization_field_mappings.length;a++)s=null===(s=this.isDefault()?this.app.organization_field_mappings[a].default_value:this.isOrganization()?this.orgObject.extra_org_fields[a].value:null)?"":s,i=null===(i=e.extra_merge_fields[r].value)?"":i,t[r+3]={label:this.app.organization_field_mappings[a].field_label,zd_field_location:"organisation",is_image:this.app.organization_field_mappings[a].type===this.app.resources.FIELD_TYPE_IMAGE,zd_value:s,mc_value:i,in_sync:s===i},r++;for(a=0;a<this.app.mailshot_only_field_mappings.length;a++)i=null===(i=e.extra_merge_fields[r].value)?"":i,t[r+3]={label:this.app.mailshot_only_field_mappings[a].field_label,zd_field_location:null,is_image:this.app.mailshot_only_field_mappings[a].type===this.app.resources.FIELD_TYPE_IMAGE,is_checkbox:this.app.mailshot_only_field_mappings[a].type===this.app.resources.FIELD_TYPE_CHECKBOX,is_checkbox_ticked:this.app.mailshot_only_field_mappings[a].type!==this.app.resources.FIELD_TYPE_CHECKBOX?null:"1"===i||1===i,zd_value:null,mc_value:i,in_sync:!0},r++;return t},ZendeskUser.prototype.isInSync=function(e,t){if(null==e&&(e=this.getFieldSyncInfo(t)),null===e)return!1;for(var s=0;s<e.length;s++)if(!e[s].in_sync)return!1;return!0};