"use strict";function ZendeskOrganization(i,s,t,n){this.app=i,this.id=s,this.name=t,this.customer_type=n,this.extra_org_fields=[];for(var e=0;e<i.field_maps.organisation.length;e++)this.extra_org_fields[e]={field_def:i.field_maps.organisation[e],value:null}}function ZendeskUser(i,s,t,n,e,l){this.app=i,this.id=s,this.name=t,this.name_parts=null,this.email=n,this.customer_type=e,this.organization_id=void 0===l?null:l,this.orgObject=null,this.extra_user_fields=[];for(var h=0;h<i.field_maps.user.length;h++)this.extra_user_fields[h]={field_def:i.field_maps.user[h],value:null}}ZendeskOrganization.prototype.populateExtraFieldsFromOrganizationAPIData=function(i){for(var s=0;s<this.extra_org_fields.length;s++)this.extra_org_fields[s].value=i.organization_fields[this.extra_org_fields[s].field_def.zendesk_field]},ZendeskOrganization.prototype.populateExtraFieldsFromFrameworkOrgObject=function(i){for(var s=0;s<this.extra_org_fields.length;s++)this.extra_org_fields[s].value=i.customField(this.extra_org_fields[s].field_def.zendesk_field)},ZendeskOrganization.prototype.clone=function(){for(var i=new ZendeskOrganization(this.app,this.id,this.name,this.customer_type),s=0;s<this.extra_org_fields.length;s++)i.extra_org_fields[s]={field_def:this.extra_org_fields[s].field_def,value:this.extra_org_fields[s].value};return i},ZendeskUser.prototype.getSalutation=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.salutation?"":this.name_parts.salutation.replace(/\w\S*/g,function(i){return i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()})},ZendeskUser.prototype.getForeName=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.firstName?"":this.name_parts.firstName.replace(/\w\S*/g,function(i){return i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()})},ZendeskUser.prototype.getSurname=function(){return this.populateNamePartsIfNecessary(),null===this.name_parts.lastName?"":this.name_parts.lastName.replace(/\w\S*/g,function(i){return i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()})},ZendeskUser.prototype.populateNamePartsIfNecessary=function(){null===this.name_parts&&null!==this.name&&(this.name_parts=this.app.parseNamesModule.parse(this.name.replace("/"," ").replace("."," ").split(",").reverse().map(Function.prototype.call,String.prototype.trim).join(" ")))},ZendeskUser.prototype.populateExtraFieldsFromUserAPIData=function(i){for(var s=0;s<this.extra_user_fields.length;s++)this.extra_user_fields[s].value=i.user_fields[this.extra_user_fields[s].field_def.zendesk_field]},ZendeskUser.prototype.populateExtraFieldsFromFrameworkUserObject=function(i){for(var s=0;s<this.extra_user_fields.length;s++)this.extra_user_fields[s].value=i.customField(this.extra_user_fields[s].field_def.zendesk_field)},ZendeskUser.prototype.clone=function(){var i=new ZendeskUser(this.app,this.id,this.name,this.email,this.customer_type,this.organization_id);i.orgObject=null===this.orgObject?null:this.orgObject.clone();for(var s=0;s<this.extra_user_fields.length;s++)i.extra_user_fields[s]={field_def:this.extra_user_fields[s].field_def,value:this.extra_user_fields[s].value};return i},ZendeskUser.prototype.isNotset=function(){return this.customer_type===this.app.resources.CUSTOMER_TYPE_NOT_SET},ZendeskUser.prototype.isExcluded=function(){return this.customer_type===this.app.resources.CUSTOMER_TYPE_EXCLUDE},ZendeskUser.prototype.isIncluded=function(){return this.customer_type===this.app.resources.CUSTOMER_TYPE_USE_ORGANIZATION||this.customer_type===this.app.resources.CUSTOMER_TYPE_USE_DEFAULT},ZendeskUser.prototype.isOrganization=function(){return this.customer_type===this.app.resources.CUSTOMER_TYPE_USE_ORGANIZATION},ZendeskUser.prototype.isDefault=function(){return this.customer_type===this.app.resources.CUSTOMER_TYPE_USE_DEFAULT},ZendeskUser.prototype.belongsToOrganization=function(){return null!==this.organization_id},ZendeskUser.prototype.orgObjectIsPopulated=function(){return null!==this.orgObject},ZendeskUser.prototype.getMailchimpCustomerType=function(){return void 0===this.customer_type||null===this.customer_type?(console.warn("ZendeskUser.getMailchimpCustomerType() called with invalid customer_type, this = "),console.dir(this),null):this.customer_type===this.app.resources.CUSTOMER_TYPE_USE_ORGANIZATION?this.orgObject.customer_type:this.app.field_maps.cust_type.default_value},ZendeskUser.prototype.findExtraFieldByName=function(i,s){for(var t=0;t<this.extra_user_fields.length;t++)if(s&&this.extra_user_fields[t].field_def.zendesk_field===i||!s&&this.extra_user_fields[t].field_def.mailchimp_field===i)return this.extra_user_fields[t]},ZendeskUser.prototype.getFieldSyncInfo=function(i){if(null==i)return null;if(void 0===this.customer_type||null===this.customer_type||this.isNotset())return console.warn("ZendeskUser.getFieldSyncInfo() called with invalid customer_type, this = "),console.dir(this),null;for(var s=[{label:"Email",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.email,mc_value:i.email_address,in_sync:this.email.toLowerCase()===i.email_address.toLowerCase()},{label:"Name",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.name,mc_value:"["+i.forename+"] ["+i.surname+"]",in_sync:i.forename.toLowerCase()===this.getForeName().toLowerCase()&&i.surname.toLowerCase()===this.getSurname().toLowerCase()},{label:"Customer Type",mc_only:!1,zd_field_location:"user",is_image:!1,zd_value:this.getMailchimpCustomerType(),mc_value:i.customer_type,in_sync:this.getMailchimpCustomerType()===i.customer_type}],t=null,n=null,e=0,l=0;l<this.extra_user_fields.length;l++)t=null===(t=this.extra_user_fields[l].value)?"":t,n=null===(n=i.extra_merge_fields[e].value)?"":n,s[e+3]={label:this.extra_user_fields[l].field_def.field_label,zd_field_location:"user",is_image:this.extra_user_fields[l].field_def.type===this.app.resources.TYPE_IMAGE,zd_value:t,mc_value:n,in_sync:t===n},e++;for(l=0;l<this.app.field_maps.organisation.length;l++)t=null===(t=this.isDefault()?this.app.field_maps.organisation[l].default_value:this.isOrganization()?this.orgObject.extra_org_fields[l].value:null)?"":t,n=null===(n=i.extra_merge_fields[e].value)?"":n,s[e+3]={label:this.app.field_maps.organisation[l].field_label,zd_field_location:"organisation",is_image:this.app.field_maps.organisation[l].type===this.app.resources.TYPE_IMAGE,zd_value:t,mc_value:n,in_sync:t===n},e++;for(l=0;l<this.app.field_maps.mc_only.length;l++)n=null===(n=i.extra_merge_fields[e].value)?"":n,s[e+3]={label:this.app.field_maps.mc_only[l].field_label,zd_field_location:null,is_image:this.app.field_maps.mc_only[l].type===this.app.resources.TYPE_IMAGE,is_checkbox:this.app.field_maps.mc_only[l].type===this.app.resources.TYPE_CHECKBOX,is_checkbox_ticked:this.app.field_maps.mc_only[l].type!==this.app.resources.TYPE_CHECKBOX?null:"1"===n||1===n,zd_value:null,mc_value:n,in_sync:!0},e++;return s},ZendeskUser.prototype.isInSync=function(i,s){if(null==i&&(i=this.getFieldSyncInfo(s)),null===i)return!1;for(var t=0;t<i.length;t++)if(!i[t].in_sync)return!1;return!0};